### js 里垃圾回收机制是什么，常用的是哪种处理，怎么处理的

> #### 浏览器的垃圾回收机制(Garbage collection),简称 GC，有些数据被使⽤之后，可能就不再需要了，我们把这种数据称为垃垃圾圾数数据据。如果这些垃圾数据⼀直保存在内存中，那么内存会越⽤越多，所以我们需要对对这些垃圾数据进⾏回收，以释放有限的内存空间。

#### 通常有三个策略

#### 引用计数：

##### 原理：设置引用数，判断当前引用数是否为 0。

```
//例子一：
let person = {
  name: "xiaoming",
  age: 10,
};

// 此处的声明是person第一次被引用
person.name = null; // person此时还在被引用
person = null; //此时person被回收

//例子二：
function fn() {
  const obj1 = {};
  const obj2 = {};
  obj1.name = obj2;
  obj2.name = obj1;
  return "111";
}
fn();
//这个例子就是典型的循环引用的例子，根据引用计数是无法回收的，但是可以被标记清除回收
// 优点：可以即时回收垃圾对象
// 缺点：无法回收循环引用的对象
```

#### 标记清除：

##### 原理：1.遍历所有对象，标记活动对象,从根部遍历 2.遍历所有对象，清除所有未标记对象(比如局部对象)

```
// 优点：解决for循环不能被回收的问题
// 缺点：容易垃圾碎片化，回收的内存一片一片的不连续，浪费空间,不会立即回收垃圾对象
```

#### 标记整理

```
// 优点：减少碎片化空间
// 缺点：不会立即回收垃圾对象
```

#### 常见的内存泄漏

```
// 1.全局变量什么时候需要自动释放空间很难判断，所以开发中尽量避免使用全局变量
// 2.定时器setTimeout/setInterval
// 3.闭包
```

// 参考文章：
// [js 内存图与垃圾回收](https://juejin.cn/post/6844903633591468040)
